{
	"name": "Aphrodite Engine - Deep Tree Echo Development",
	"dockerFile": "Dockerfile",
	"build": {
		"context": ".."
	},
	"workspaceFolder": "/workspace",
	"forwardPorts": [
		2242,  
		8000,  
		6006,  
		8888,  
		5901   
	],
	"portsAttributes": {
		"2242": {
			"label": "Aphrodite API",
			"protocol": "http"
		},
		"8000": {
			"label": "Alternative API",
			"protocol": "http"
		},
		"6006": {
			"label": "TensorBoard",
			"protocol": "http"
		},
		"8888": {
			"label": "Jupyter",
			"protocol": "http"
		},
		"5901": {
			"label": "VNC Display",
			"protocol": "http"
		}
	},
	"customizations": {
		"vscode": {
			"extensions": [
				"ms-python.python",
				"ms-python.pylint",
				"ms-python.mypy-type-checker",
				"charliermarsh.ruff",
				"ms-python.black-formatter",
				"ms-python.isort",
				"ms-azuretools.vscode-docker",
				"GitHub.copilot",
				"GitHub.copilot-chat",
				"ms-vscode.cmake-tools",
				"twxs.cmake",
				"ms-vscode.cpptools",
				"vadimcn.vscode-lldb",
				"tamasfe.even-better-toml",
				"redhat.vscode-yaml",
				"ms-vscode.hexeditor",
				"GitHub.vscode-github-actions",
				"ms-toolsai.jupyter",
				"ms-toolsai.vscode-jupyter-cell-tags",
				"ms-toolsai.jupyter-keymap",
				"ms-toolsai.jupyter-renderers"
			],
			"settings": {
				"python.defaultInterpreterPath": "/usr/local/bin/python",
				"python.linting.enabled": true,
				"python.linting.pylintEnabled": false,
				"python.linting.mypyEnabled": true,
				"python.formatting.provider": "black",
				"python.analysis.typeCheckingMode": "basic",
				"ruff.enable": true,
				"ruff.organizeImports": true,
				"editor.formatOnSave": true,
				"editor.codeActionsOnSave": {
					"source.organizeImports": "explicit"
				},
				"terminal.integrated.defaultProfile.linux": "bash",
				"cmake.configureOnOpen": false,
				"files.watcherExclude": {
					"**/build/**": true,
					"**/dist/**": true,
					"**/.git/**": true,
					"**/node_modules/**": true,
					"**/.venv/**": true,
					"**/venv/**": true
				}
			}
		}
	},
	"containerEnv": {
		"APHRODITE_TARGET_DEVICE": "${localEnv:APHRODITE_TARGET_DEVICE:cpu}",
		"CUDA_VISIBLE_DEVICES": "${localEnv:CUDA_VISIBLE_DEVICES}",
		"PYTHONPATH": "/workspace",
		"PYTHONUNBUFFERED": "1",
		"DISPLAY": ":1",
		"XAUTHORITY": "/tmp/.Xauthority",
		"HF_HUB_ENABLE_HF_TRANSFER": "1",
		"ECHO_ENABLE_DEEP_TREE": "true",
		"ECHO_ENABLE_VM_DAEMON": "true",
		"DEEP_TREE_ECHO_MODE": "development",
		"CMAKE_BUILD_TYPE": "Release",
		"MAX_JOBS": "4",
		"CCACHE_DIR": "/workspace/.ccache",
		"CCACHE_MAXSIZE": "5G"
	},
	"remoteEnv": {
		"PATH": "${containerEnv:PATH}:/usr/local/cuda/bin:/opt/rocm/bin",
		"LD_LIBRARY_PATH": "${containerEnv:LD_LIBRARY_PATH}:/usr/local/cuda/lib64:/opt/rocm/lib"
	},
	"mounts": [
		{
			"source": "aphrodite-cache",
			"target": "/root/.cache",
			"type": "volume"
		},
		{
			"source": "aphrodite-ccache", 
			"target": "/workspace/.ccache",
			"type": "volume"
		},
		{
			"source": "huggingface-cache",
			"target": "/root/.cache/huggingface",
			"type": "volume"
		}
	],
	"features": {
		"ghcr.io/devcontainers/features/docker-outside-of-docker:1": {
			"moby": false,
			"dockerDashComposeVersion": "v2"
		},
		"ghcr.io/devcontainers/features/github-cli:1": {},
		"ghcr.io/devcontainers/features/git:1": {
			"ppa": true,
			"version": "latest"
		}
	},
	"postCreateCommand": "bash .devcontainer/post-create.sh",
	"postStartCommand": "bash .devcontainer/post-start.sh",
	"remoteUser": "vscode",
	"overrideCommand": false,
	"shutdownAction": "stopContainer"
}